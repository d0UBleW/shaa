---
sections:
  "1":
    title: Initial Setup
    subsections:
      - "1.1"
      - "1.2"
      - "1.3"
      - "1.4"
      - "1.5"
      - "1.6"
      - "1.7"
      - "1.8"

  "1.1":
    title: Filesystem Configuration
    subsections:
      - 1.1.1
      - 1.1.2
      - 1.1.3
      - 1.1.4
      - 1.1.5
      - 1.1.6
      - 1.1.7
      - 1.1.8
      - 1.1.9
      - 1.1.10
      - 1.1.11
      - 1.1.12
      - 1.1.13
      - 1.1.14
      - 1.1.15
      - 1.1.16
      - 1.1.17
      - 1.1.18
      - 1.1.19
      - 1.1.20
      - 1.1.21
      - 1.1.22
      - 1.1.23

  1.1.1:
    title: Disable unused filesystems
    subsections:
      - "1.1.1.1"
      - "1.1.1.2"
      - "1.1.1.3"
      - "1.1.1.4"
      - "1.1.1.5"
      - "1.1.1.6"
      - "1.1.1.7"
      - "1.1.1.8"

  1.1.1.1:
    title: Ensure mounting of cramfs filesytems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.2:
    title: Ensure mounting of freevxfs filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.3:
    title: Ensure mounting of jffs2 filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.4:
    title: Ensure mounting of hfs filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.5:
    title: Ensure mounting of hfsplus filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.6:
    title: Ensure mounting of squashfs filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.7:
    title: Ensure mounting of udf filesystems is disabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  1.1.1.8:
    title: Ensure mounting of FAT filesystems is limited
    profile:
      - Level 2 - Server
      - Level 2 - Workstation
    vars:

  1.1.2:
    title: Ensure /tmp is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.3:
    title: Ensure nodev option set on /tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.4:
    title: Ensure nosuid option set on /tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.5:
    title: Ensure noexec option set on /tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.6:
    title: Ensure separate partition exists for /var
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.1.7:
    title: Ensure separate partition exists for /var/tmp
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.1.8:
    title: Ensure nodev option set on /var/tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.9:
    title: Ensure nosuid option set on /var/tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.10:
    title: Ensure noexec option set on /var/tmp partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.11:
    title: Ensure noexec option set on /var/tmp partition
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.1.12:
    title: Ensure noexec option set on /var/tmp partition
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.1.13:
    title: Ensure separate parition exists for /home
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.1.14:
    title: Ensure nodev option set on /home partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.15:
    title: Ensure nodev option set on /dev/shm partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.16:
    title: Ensure nosuid option set on /dev/shm partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.17:
    title: Ensure noexec option set on /dev/shm partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.18:
    title: Ensure nodev option set on removable media partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.19:
    title: Ensure nosuid option set on removable media partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.20:
    title: Ensure noexec option set on removable media partition
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.21:
    title: Ensure sticky bit is set on all world-writable directories
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.1.22:
    title: Disable automounting
    profile:
      - Level 1 Server
      - Level 2 Workstation
    vars:

  1.1.23:
    title: Disable USB Storage
    profile:
      - Level 1 Server
      - Level 2 Workstation
    vars:

  "1.2":
    title: Configure Software Update
    subsections:
      - 1.2.1
      - 1.2.2

  1.2.1:
    title: Ensure package manager repositories are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.2.2:
    title: Ensure GPG keys are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "1.3":
    title: Filesystem Integrity Checking
    subsections:
      - 1.3.1
      - 1.3.2

  1.3.1:
    title: Ensure AIDE is installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.3.2:
    title: Ensure filesystem integrity is regularly checked
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      aide_cron_user:
        default: root
        description: user who will run the cron job
        value_type: single
        valid:
      aide_cron_weekday:
        default: "*"
        description: |-
          cron setting for weekday frequency
          Possible value: 0-7 (0 and 7 is Sunday), * for every weekday
        value_type: range
        range_start: 0
        range_end: 7
        valid:
          - "*"
      aide_cron_month:
        default: "*"
        description: |
          cron setting for month frequency
          Possible value: 1-12, * for every month
        value_type: range
        range_start: 1
        range_end: 12
        valid:
          - "*"
      aide_cron_day:
        default: "*"
        description: |
          cron setting for day frequency
          Possible value: number of days in a month, * for every day
        value_type: range
        range_start: 1
        range_end: 31
        valid:
          - "*"
      aide_cron_hour:
        default: "1"
        description: |
          cron setting for hour frequency
          Possible value: 0-23, * for every hour
        value_type: range
        range_start: 0
        range_end: 23
        valid:
          - "*"
      aide_cron_minute:
        default: "*"
        description: |
          cron setting for minute frequency
          Possible value: 0-59, * for every minute
        value_type: range
        range_start: 0
        range_end: 59
        valid:
          - "*"

  "1.4":
    title: Secure Boot Settings
    subsections:
      - 1.4.1
      - 1.4.2
      - 1.4.3
      - 1.4.4

  1.4.1:
    title: Ensure permissions on bootloader config are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.4.2:
    title: Ensure bootloader password is set
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      bootloader_superuser:
        default: "root"
        description: |
          Username to access bootloader
        value_type: single
        valid:
      bootloader_password:
        default:
        description: |
          Password to access bootloader
        value_type: sensitive
        valid:

  1.4.3:
    title: Ensure authentication required for single user mode
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      root_password:
        default:
        description: |
          Password for root user
        value_type: sensitive
        valid:

  1.4.4:
    title: Ensure interactive boot is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "1.5":
    title: Additional Process Hardening
    subsections:
      - 1.5.1
      - 1.5.2
      - 1.5.3
      - 1.5.4

  1.5.1:
    title: Ensure core dumps are restricted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.5.2:
    title: Ensure XD/NX support is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.5.3:
    title: Ensure address space layout randomization (ASLR) is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.5.4:
    title: Ensure prelink is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "1.6":
    title: Mandatory Access Control
    subsections:
      - 1.6.1
      - 1.6.2
      - 1.6.3
    vars:
      debian_mac:
        default: apparmor
        description: |
          Mandatory Access Control (MAC) for Debian-based distribution family
        value_type: choice
        valid:
          - apparmor
          - selinux
      suse_mac:
        default: selinux
        description: |
          Mandatory Access Control (MAC) for Suse-based distribution family
        value_type: choice
        valid:
          - apparmor
          - selinux
      redhat_mac:
        default: selinux
        description: |
          Mandatory Access Control (MAC) for RedHat-based distribution family
        value_type: choice
        valid:
          - selinux

  1.6.1:
    title: Ensure Mandatory Access Control Software is installed
    subsections:
      - 1.6.1.1
    vars:

  1.6.1.1:
    title: Ensure mounting of cramfs filesystems is disabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.2:
    title: Configure SELinux
    subsections:
      - 1.6.2.1
      - 1.6.2.2
      - 1.6.2.3
      - 1.6.2.4
      - 1.6.2.5
      - 1.6.2.6

  1.6.2.1:
    title: Ensure SELinux is not disabled in bootloader configuration
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.2.2:
    title: Ensure the SELinux state is enforcing
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.2.3:
    title: Ensure SELinux policy is configured
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:
      selinuxtype:
        default: "targeted"
        description: |
          SELinux type, possible values: targeted, strict, mls
        value_type: choice
        valid:
          - targeted
          - strict
          - mls

  1.6.2.4:
    title: Ensure SETroubleshoot is not installed
    profile:
      - Level 2 Server
    vars:

  1.6.2.5:
    title: Ensure the MCS Translation Service (mcstrans) is not installed
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.2.6:
    title: Ensure no unconfined daemon exist
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.3:
    title: Configure AppArmor
    subsections:
      - 1.6.3.1
      - 1.6.3.2

  1.6.3.1:
    title: Ensure AppArmor is not disabled in bootloader configuration
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  1.6.3.2:
    title: Ensure AppArmor is not disabled in bootloader configuration
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  "1.7":
    title: Warning Banners
    subsections:
      - 1.7.1
      - 1.7.2

  1.7.1:
    title: Command Line Warning Banners
    subsections:
      - 1.7.1.1
      - 1.7.1.2
      - 1.7.1.3
      - 1.7.1.4
      - 1.7.1.5
      - 1.7.1.6

  1.7.1.1:
    title: Ensure message of the day is configured properly
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      etc_motd:
        default: "Hello"
        description: |
          Content of /etc/motd
        value_type: single
        valid:

  1.7.1.2:
    title: Ensure local login warning banner is configured properly
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.7.1.3:
    title: Ensure remote login warning banner is configured properly
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.7.1.4:
    title: Ensure permissions on /etc/motd are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.7.1.5:
    title: Ensure permissions on /etc/issue are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.7.1.6:
    title: Ensure permissions on /etc/issue.net are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  1.7.2:
    title: Ensure GDM login banner is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      gdm_banner_message:
        default: >-
          Authorized uses only. All activity may be monitored and reported
        description: |
          Content of gdm banner
        value_type: single
        valid:

  "1.8":
    title: >-
      Ensure update, patches, and additional security software are installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "2":
    title: Services
    subsections:
      - "2.1"
      - "2.2"
      - "2.3"

  "2.1":
    title: inetd Services
    subsections:
      - 2.1.1
      - 2.1.2
      - 2.1.3
      - 2.1.4
      - 2.1.5
      - 2.1.6
      - 2.1.7
      - 2.1.8
      - 2.1.9
      - 2.1.10

  2.1.1:
    title: Ensure chargen services are not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.2:
    title: Ensure daytime services are not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.3:
    title: Ensure discard services are not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.4:
    title: Ensure echo services are not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.5:
    title: Ensure time services are not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.6:
    title: Ensure rsh server is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.7:
    title: Ensure talk server is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.8:
    title: Ensure telnet server is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.9:
    title: Ensure tftp server is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.1.10:
    title: Ensure xinetd is not enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "2.2":
    title: Special Purpose Services
    subsections:
      - 2.2.1
      - 2.2.2
      - 2.2.3
      - 2.2.4
      - 2.2.5
      - 2.2.6
      - 2.2.7
      - 2.2.8
      - 2.2.9
      - 2.2.10
      - 2.2.11
      - 2.2.12
      - 2.2.13
      - 2.2.14
      - 2.2.15
      - 2.2.16
      - 2.2.17

  2.2.1:
    title: Time Synchronization
    subsections:
      - 2.2.1.1
      - 2.2.1.2
      - 2.2.1.3
      - 2.2.1.4

  2.2.1.1:
    title: Ensure time synchronization is in use
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:
      time_synchronization:
        default: systemd-timesyncd
        description: |
          Time synchronization service name,
          possible values: ntp, chrony, systemd-timesyncd

          Note: AlmaLinux only has chrony
        value_type: choice
        valid:
          - ntp
          - chrony
          - systemd-timesyncd

  2.2.1.2:
    title: Ensure ntp is configured
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:
      time_sync_remote_server:
        default: "time1.google.com"
        description: |
          NTP remote server to sync with
        value_type: single
        valid:
      ntp_options:
        default:
          - kod
          - nomodify
          - notrap
          - nopeer
          - noquery
        description: |
          NTP remote server to sync with
        value_type: list_choice
        valid:
          - kod
          - nomodify
          - notrap
          - nopeer
          - noquery

  2.2.1.3:
    title: Ensure chrony is configured
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.1.4:
    title: Ensure systemd-timesyncd is configured
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:
      systemd_timesyncd_main_ntp:
        default:
          - time1.google.com
          - time2.google.com
        description: |
          Main NTP remote servers to sync with
        value_type: list
        valid:
      systemd_timesyncd_fallback_ntp:
        default:
          - time3.google.com
          - time4.google.com
          - time.cloudflare.com
        description: |
          Fallback NTP remote servers to sync with
        value_type: list
        valid:
      systemd_timesyncd_root_distance_max:
        default: "1"
        description: |
          Maximum acceptable root distance, i.e. the maximum estimated time
          (in seconds) required for a packet to travel to the server we are
          connected to from the server with the reference clock.
        value_type: range
        range_start: 1
        range_end:
        valid:

  2.2.2:
    title: Ensure X Window System is not installed
    profile:
      - Level 1 - Server
    vars:

  2.2.3:
    title: Ensure Avahi Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.4:
    title: Ensure CUPS is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.5:
    title: Ensure DHCP Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.6:
    title: Ensure LDAP Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.7:
    title: Ensure NFS and RPC is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.8:
    title: Ensure DNS Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.9:
    title: Ensure FTP Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.10:
    title: Ensure HTTP Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.11:
    title: Ensure IMAP and POP3 Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.12:
    title: Ensure Samba is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.13:
    title: Ensure HTTP Proxy Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.14:
    title: Ensure SNMP Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.15:
    title: Ensure mail transfer agent is configured for local-only mode
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.16:
    title: Ensure rsync service is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  2.2.17:
    title: Ensure NIS Server is not enabled
    profile:
      - Level 1 - Server
      - Level 1 - Workstation
    vars:

  "2.3":
    title: Service Clients
    subsections:
      - 2.3.1
      - 2.3.2
      - 2.3.3
      - 2.3.4
      - 2.3.5

  2.3.1:
    title: Ensure NIS client is not installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.3.2:
    title: Ensure rsh client is not installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.3.3:
    title: Ensure talk client is not installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.3.4:
    title: Ensure telnet client is not installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  2.3.5:
    title: Ensure LDAP client is not installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "3":
    title: Network Configuration
    subsections:
      - "3.1"
      - "3.2"
      - "3.3"
      - "3.4"
      - "3.5"
      - "3.6"
      - "3.7"

  "3.1":
    title: Network Parameters (Host Only)
    subsections:
      - 3.1.1
      - 3.1.2

  3.1.1:
    title: Ensure IP forwarding is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.1.2:
    title: Ensure packet redirect sending is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "3.2":
    title: Network Parameters (Host and Router)
    subsections:
      - 3.2.1
      - 3.2.2
      - 3.2.3
      - 3.2.4
      - 3.2.5
      - 3.2.6
      - 3.2.7
      - 3.2.8
      - 3.2.9

  3.2.1:
    title: Ensure source routed packets are not accepted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.2:
    title: Ensure ICMP redirects are not accepted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.3:
    title: Ensure secure ICMP redirects are not accepted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.4:
    title: Ensure suspicious packets are logged
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.5:
    title: Ensure broadcast ICMP requests are ignored
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.6:
    title: Ensure bogus ICMP responses are ignored
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.7:
    title: Ensure Reverse Path Filtering is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.8:
    title: Ensure TCP SYN Cookies is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.2.9:
    title: Ensure IPv6 router advertisements are not accepted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "3.3":
    title: TCP Wrappers
    subsections:
      - 3.3.1
      - 3.3.2
      - 3.3.3
      - 3.3.4

  3.3.1:
    title: Ensure TCP Wrappers is installed
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.3.2:
    title: Ensure /etc/hosts.allow is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      hosts_allow:
        default:
          "ALL EXCEPT in.fingerd":
            - 192.168.0.0/255.255.255.0
            - 192.168.1.0/24
            - 192.168.2.*
            - .example.com
          "sshd":
            - "10."
            - 192.168.0.0/16
            - 172.16.0.0/12
        description: |
          TCP wrappers rule for allowing hosts
          cis set -s 3.3.2 "ALL EXCEPT in.fingerd" .example.com,192.168.2.* "sshd" 10.
        value_type: dict
        valid:
      hosts_allow_cleanup:
        default: true
        description: |
          Clean up unspecified rules
        value_type: bool
        valid:

  3.3.3:
    title: Ensure /etc/hosts.deny is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      hosts_deny:
        default:
          ALL:
            - ALL
        description: |
          TCP wrappers rule for denying hosts
        value_type: dict
        valid:
      hosts_deny_cleanup:
        default: true
        description: |
          Clean up unspecified rules
        value_type: bool
        valid:

  3.3.4:
    title: Ensure permissions on /etc/hosts.allow are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.3.5:
    title: Ensure permissions on /etc/hosts.deny are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "3.4":
    title: Uncommon Network Protocols
    subsections:
      - 3.4.1
      - 3.4.2
      - 3.4.3
      - 3.4.4

  3.4.1:
    title: Ensure dccp module is disabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  3.4.2:
    title: Ensure sctp module is disabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  3.4.3:
    title: Ensure rds module is disabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  3.4.4:
    title: Ensure tipc module is disabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  "3.5":
    title: Firewall Configuration
    subsections:
      - 3.5.1
      - 3.5.2
      - 3.5.3
      - 3.5.4

  3.5.1:
    title: Configure IPv6 ip6tables
    subsections:
      - 3.5.1.1
      - 3.5.1.2
      - 3.5.1.3
      - 3.5.1.4
    vars:
      flush_ip6tables:
        default: true
        description: |
          Clean up ip6tables rules before configuring subsequent stuffs
        value_type: bool
        valid:

  3.5.1.1:
    title: Ensure IPv6 default deny firewall policy
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.5.1.2:
    title: Ensure IPv6 loopback traffic is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.5.1.3:
    title: Ensure IPv6 outbound and established connections are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.5.1.4:
    title: Ensure IPv6 firewall rules exists for all open ports
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      ip6tables_rules:
        default:
          - port: 22
            protocol: tcp
          - port: 80
            protocol: tcp
        description: |
          Allow traffic to specified ports and protocols
          cis set -s 3.5.1.4 ip6tables_rules 22/tcp 80/tcp 443/tcp 8080/tcp
        value_type: list_dict
        valid:
      save_ip6tables_rules:
        default: true
        description: |
          Persist ip6tables rules
        value_type: bool
        valid:

  3.5.2:
    title: Configure IPv4 iptables
    subsections:
      - 3.5.2.1
      - 3.5.2.2
      - 3.5.2.3
      - 3.5.2.4
    vars:
      flush_iptables:
        default: true
        description: |
          Clean up iptables rules before configuring subsequent stuffs
        value_type: bool
        valid:

  3.5.2.2:
    title: Ensure IPv4 loopback traffic is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.5.2.3:
    title: Ensure IPv4 outbound and established connections are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  3.5.2.4:
    title: Ensure IPv4 firewall rules exists for all open ports
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      iptables_rules:
        default:
          - port: 22
            protocol: tcp
          - port: 80
            protocol: tcp
          - port: 514
            protocol: tcp
        description: |
          Allow traffic to specified ports and protocols
          cis set -s 3.5.2.4 iptables_rules 22/tcp 80/tcp 443/tcp 8080/tcp
        value_type: list_dict
        valid:
      save_iptables_rules:
        default: true
        description: |
          Persist iptables rules
        value_type: bool
        valid:

  "3.6":
    title: Ensure wireless interfaces are disabled
    profile:
      - Level 1 Server
      - Level 2 Workstation
    vars:

  "3.7":
    title: Disable IPv6
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  "4":
    title: Logging and Auditing
    subsections:
      - "4.1"
      - "4.2"
      - "4.3"

  "4.1":
    title: Configure System Auditing (auditd)
    subsections:
      - 4.1.1
      - 4.1.2
      - 4.1.3
      - 4.1.4
      - 4.1.5
      - 4.1.6
      - 4.1.7
      - 4.1.8
      - 4.1.9
      - 4.1.10
      - 4.1.11
      - 4.1.12
      - 4.1.13
      - 4.1.14
      - 4.1.15
      - 4.1.16
      - 4.1.17
      - 4.1.18
      - 4.1.19

  4.1.1:
    title: Configure System Auditing (auditd)
    subsections:
      - 4.1.1.1
      - 4.1.1.2
      - 4.1.1.3

  4.1.1.1:
    title: Ensure audit log storage size is configured
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:
      max_log_file:
        default: 10
        description: |
          Maximum size measured in MB (Megabytes)
        value_type: range
        range_start: 1
        range_end:
        valid:

  4.1.1.2:
    title: Ensure system is disabled when audit logs are full
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:
      space_left_action:
        default: syslog
        description: |
          Tells the system what action to take when the system has detected
          that it is starting to get low on disk space.
          Possible values: ignore, syslog, rotate, email, exec, suspend,
          single, halt
        value_type: choice
        valid:
          - ignore
          - syslog
          - rotate
          - email
          - exec
          - suspend

  4.1.1.3:
    title: Ensure audit logs are not automatically deleted
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.2:
    title: Ensure auditd is installed
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.3:
    title: Ensure auditd service is enabled
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.4:
    title: Enable auditing for processes that start prior to auditd is
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.5:
    title: Ensure events that modify date and time information are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.6:
    title: Ensure events that modify user/group information are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.7:
    title: Ensure events that modify system's network environment are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.8:
    title: >
      Ensure events that modify system's Mandatory Access Controls are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.9:
    title: Ensure login and logout events are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.10:
    title: Ensure session initiation information is collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.11:
    title: >
      Ensure discretionary access control permission configuration events are
      collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.12:
    title: Ensure unsuccessful unauthorized file access attempts are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.13:
    title: Ensure use of privileged commands is collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.14:
    title: Ensure successful file system mounts are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.15:
    title: Ensure file deletion events by users are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.16:
    title: Ensure chanes to system administration scope (sudoers) is collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.17:
    title: Ensure system adminitration actions (sudolog) are collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.18:
    title: Ensure kernel module loading and unloading is collected
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  4.1.19:
    title: Ensure the audit configuration is immutable
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:

  "4.2":
    title: Configure Logging
    subsections:
      - 4.2.1
      - 4.2.2
      - 4.2.3

  4.2.1:
    title: Configure rsyslog
    subsections:
      - 4.2.1.1
      - 4.2.1.2
      - 4.2.1.3
      - 4.2.1.4
      - 4.2.1.5
      - 4.2.1.6

  4.2.1.1:
    title: Ensure rsyslog is installed
    profile:
      - Level 1 Server
      - Level 1 Workstation

  4.2.1.2:
    title: Ensure rsyslog Service is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation

  4.2.1.3:
    title: Ensure logging is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  4.2.1.4:
    title: Ensure rsyslog default file permissions configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  4.2.1.5:
    title: Ensure rsyslog is configured to send logs to a remote host
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      rsyslog_remote_host:
        default: loghost.example.com
        description: |
          The target remote host to send logs to
        value_type: single
        valid:

  4.2.1.6:
    title: >
      Ensure remote syslog messages are only accepted on designated log hosts
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      rsyslog_is_log_hosts:
        default: true
        description: |
          Denotes that the host is listening for remote logs
        value_type: bool
        valid:
      rsyslog_log_hosts_listen_port:
        default: 514
        description: |
          Specify the port to listen for remote logs
        value_type: range
        range_start: 1
        range_end: 65535
        valid:

  4.2.2:
    title: Configure journald
    subsections:
      - 4.2.1.1
      - 4.2.1.2
      - 4.2.1.3
      - 4.2.1.4
      - 4.2.1.5
      - 4.2.1.6

  4.2.2.1:
    title: Ensure journald is configured to send logs to rsyslog
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  4.2.2.2:
    title: Ensure journald is configured to compress large log files
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  4.2.2.3:
    title: Ensure journald is configured to write logfiles to persistent disk
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  4.2.3:
    title: Ensure permissions on all logfiles are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "4.3":
    title: Ensure logrotate is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      rotate_period:
        default: yearly
        description: |
          How frequent should log files be rotated
        value_type: choice
        valid:
          - hourly
          - daily
          - weekly
          - monthly
          - yearly

  "5":
    title: Access, Authentication and Authorization
    subsections:
      - "5.1"
      - "5.2"
      - "5.3"
      - "5.4"
      - "5.5"
      - "5.6"

  "5.1":
    title: Configure Cron
    subsections:
      - 5.1.1
      - 5.1.2
      - 5.1.3
      - 5.1.4
      - 5.1.5
      - 5.1.6
      - 5.1.7
      - 5.1.8

  5.1.1:
    title: Ensure cron daemon is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.2:
    title: Ensure permissions on /etc/crontab are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.3:
    title: Ensure permissions on /etc/cron.hourly are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.4:
    title: Ensure permissions on /etc/cron.daily are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.5:
    title: Ensure permissions on /etc/cron.weekly are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.6:
    title: Ensure permissions on /etc/cron.monthly are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.7:
    title: Ensure permissions on /etc/cron.d are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.1.8:
    title: Ensure at/cron is restricted to authorized users
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "5.2":
    title: SSH Server Configuration
    subsections:
      - 5.2.1
      - 5.2.2
      - 5.2.3
      - 5.2.4
      - 5.2.5
      - 5.2.6
      - 5.2.7
      - 5.2.8
      - 5.2.9
      - 5.2.10
      - 5.2.11
      - 5.2.12
      - 5.2.13
      - 5.2.14
      - 5.2.15
      - 5.2.16
      - 5.2.17
      - 5.2.18
      - 5.2.19
      - 5.2.20
      - 5.2.21
      - 5.2.22
      - 5.2.23

  5.2.1:
    title: Ensure permisisons on /etc/ssh/sshd_config are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.2:
    title: Ensure permissions on SSH private host key files are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.3:
    title: Ensure permissions on SSH public host key files are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.4:
    title: Ensure SSH Protocol is set to 2
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.5:
    title: Ensure SSH LogLevel is appropriate
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_log_level:
        default: "VERBOSE"
        description: |
          SSH daemon logging level
        value_type: choice
        valid:
          - VERBOSE
          - INFO

  5.2.6:
    title: Ensure SSH X11 forwarding is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.7:
    title: Ensure SSH MaxAuthTries is set to 4 or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      ssh_max_auth_tries:
        default: 4
        description: |
          Number of authentication attempts allowed for each connection
        value_type: range
        range_start: 1
        range_end: 4
        valid:

  5.2.8:
    title: Ensure SSH IgnoreRhosts is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.9:
    title: Ensure SSH HostbasedAuthentication is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.10:
    title: Ensure SSH root login is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.11:
    title: Ensure SSH PermitEmptyPasswords is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.12:
    title: Ensure SSH PermitUserEnvironment is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.13:
    title: Ensure only strong Ciphers are used
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_ciphers:
        default:
          - aes256-ctr
          - aes192-ctr
          - aes128-ctr
        description: |
          SSH cipher algorithms
        value_type: list_choice
        valid:
          - aes256-ctr
          - aes192-ctr
          - aes128-ctr

  5.2.14:
    title: Ensure only strong MAC algorithms are used
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_mac_algs:
        default:
          - hmac-sha2-256
          - hmac-sha2-512
        description: |
          SSH MAC algorithms
        value_type: list_choice
        valid:
          - hmac-sha2-256
          - hmac-sha2-512

  5.2.15:
    title: Ensure only strong Key Exchange algorithms are used
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_kex_algs:
        default:
          - ecdh-sha2-nistp256
          - ecdh-sha2-nistp384
          - ecdh-sha2-nistp521
          - diffie-hellman-group-exchange-sha256
          - diffie-hellman-group16-sha512
          - diffie-hellman-group18-sha512
          - diffie-hellman-group14-sha256
        description: |
          SSH KeX algorithms
        value_type: list_choice
        valid:
          - ecdh-sha2-nistp256
          - ecdh-sha2-nistp384
          - ecdh-sha2-nistp521
          - diffie-hellman-group-exchange-sha256
          - diffie-hellman-group16-sha512
          - diffie-hellman-group18-sha512
          - diffie-hellman-group14-sha256

  5.2.16:
    title: Ensure SSH Idle Timeout Interval is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_idle_timeout:
        default: 300
        description: |
          Duration of idle measured in seconds.
          After certain amount of seconds, the ssh connection would be closed
        value_type: range
        range_start: 30
        range_end:
        valid:
      sshd_idle_timeout_msg:
        default: 0
        description: |
          Number of warnings before terminating the ssh connection.
          0 means terminate session instantly without any warning message
        value_type: range
        range_start: 0
        range_end:
        valid:

  5.2.17:
    title: Ensure SSH LoginGraceTime is set to one minute or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_login_grace_time:
        default: 60
        description: |
          Number of seconds before login attempt is terminated
        value_type: range
        range_start: 0
        range_end: 60
        valid:

  5.2.18:
    title: Ensure SSH access is limited
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_allow_users:
        default:
          - "*"
        description: |
          List of allowed usernames to login through ssh.
          Asterisk (*) is a wildcard which means any users
        value_type: list
        valid:
      sshd_allow_groups:
        default:
          - "*"
        description: |
          List of allowed groups to login through ssh.
          Asterisk (*) is a wildcard which means any groups
        value_type: list
        valid:
      sshd_deny_users:
        default:
          - root
          - bar@10.0.0.1
        description: |
          List of denied usernames to login through ssh.
          Asterisk (*) is a wildcard which means any users
        value_type: list
        valid:
      sshd_deny_groups:
        default:
          - sudo
        description: |
          List of denied groups to login through ssh.
          Asterisk (*) is a wildcard which means any groups
        value_type: list
        valid:

  5.2.19:
    title: Ensure SSH warning banner is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_banner:
        default: "/etc/issue.net"
        description: |
          Path to file used for displaying warning banner
        value_type: single
        valid:

  5.2.20:
    title: Ensure SSH PAM is enabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.21:
    title: Ensure SSH AllowTcpForwarding is disabled
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.2.22:
    title: Ensure SSH MaxStartups is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_max_startups:
        default: "10:30:60"
        description: |
          Specifies the maximum number of concurrent unauthenticated connections
          to the SSH daemon. Additional connections will be dropped until
          authentication succeeds or the LoginGraceTime expires for a
          connection.
          Alternatively, random early drop can be enabled by specifying the
          three colon separated values "start:rate:full" (e.g. "10:30:60").
          sshd(8) will refuse connection attempts with a probability of
          "rate/100" (30%) if there are currently "start" (10) unauthenticated
          connections. The probability increases linearly and all connection
          attempts are refused if the number of unauthenticated connections
          reaches "full" (60).
        value_type: single
        valid:

  5.2.23:
    title: Ensure SSH MaxSessions is set to 4 or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      sshd_max_sessions:
        default: 4
        description: |
          Specify the max number of authenticated sessions.
        value_type: range
        range_start: 1
        range_end: 4
        valid:

  "5.3":
    title: Configure PAM
    subsections:
      - 5.3.1
      - 5.3.2
      - 5.3.3
      - 5.3.4

  5.3.1:
    title: Configure PAM
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pwquality_retry:
        default: 3
        description: |
          Number of password change attempts
        value_type: range
        range_start: 1
        range_end: 3
        valid:
      pwquality_minlen:
        default: 14
        description: |
          Minimal length of new password
        value_type: range
        range_start: 8
        range_end:
        valid:
      pwquality_dcredit:
        default: -1
        description: |
          Number of digit in new password
          Negative is minum, positive is maximum, 0 is disable
        value_type: range
        range_start:
        range_end:
        valid:
      pwquality_ucredit:
        default: -1
        description: |
          Number of uppercase letter in new password
          Negative is minum, positive is maximum, 0 is disable
        value_type: range
        range_start:
        range_end:
        valid:
      pwquality_ocredit:
        default: -1
        description: |
          Number of special symbol in new password
          Negative is minum, positive is maximum, 0 is disable
        value_type: range
        range_start:
        range_end:
        valid:
      pwquality_lcredit:
        default: -1
        description: |
          Number of lowercase letter in new password
          Negative is minum, positive is maximum, 0 is disable
        value_type: range
        range_start:
        range_end:
        valid:

  5.3.2:
    title: Ensure lockout for failed password attempts is configured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pam_auth_fail_try:
        default: 2
        description: |
          Number of authentication attempts before getting locked out
        value_type: range
        range_start: 1
        range_end:
        valid:
      pam_auth_lock_time:
        default: 10
        description: |
          Lockout period measured in seconds
        value_type: range
        range_start: 10
        range_end:
        valid:

  5.3.3:
    title: Ensure password reuse is limited
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pam_password_reuse_history:
        default: 5
        description: |
          Prevent reuse of last N passwords
        value_type: range
        range_start: 0
        range_end:
        valid:

  5.3.4:
    title: Ensure password hashing algorithm is SHA-512
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      force_password_change:
        default: true
        description: |
          Force password change on non system users
        value_type: bool
        valid:

  "5.4":
    title: User Accounts and Environment
    subsections:
      - 5.4.1
      - 5.4.2
      - 5.4.3
      - 5.4.4
      - 5.4.5

  5.4.1:
    title: Set Shadow Password Suite Parameters
    subsections:
      - 5.4.1.1
      - 5.4.1.2
      - 5.4.1.3
      - 5.4.1.4
      - 5.4.1.5

  5.4.1.1:
    title: Ensure password expiration is 365 days or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pass_max_days:
        default: 365
        description: |
          Password lifetime
        value_type: range
        range_start: 1
        range_end: 365
        valid:

  5.4.1.2:
    title: Ensure minimum days between password change is 7 or more
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pass_min_days:
        default: 7
        description: |
          Minimum days before a password could be changed again
        value_type: range
        range_start: 7
        range_end:
        valid:

  5.4.1.3:
    title: Ensure password expiration warning days is 7 or more
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      pass_warn_age:
        default: 14
        description: |
          Number of days before warning on password expiration is given
        value_type: range
        range_start: 7
        range_end:
        valid:

  5.4.1.4:
    title: Ensure inactive password lock is 30 days or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      inactive_days:
        default: 30
        description: |
          Number of inactive days before the password is locked out
        value_type: range
        range_start: 1
        range_end: 30
        valid:

  5.4.1.5:
    title: Ensure all users last password change date is in the past
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.4.2:
    title: Ensure system accounts are secured
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.4.3:
    title: Ensure default group for the root account is GID 0
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  5.4.4:
    title: Ensure default user umask is 027 or more restrictive
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      user_umask:
        default: "027"
        description: |
          umask value
        value_type: single
        valid:

  5.4.5:
    title: Ensure default user shell timeout is 900 seconds or less
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      user_shell_timeout:
        default: 900
        description: |
          Number of idle seconds before a user is logged out from the shell
        value_type: range
        range_start: 60
        range_end: 900
        valid:

  "5.5":
    title: Ensure root login is restricted to system console
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "5.6":
    title: Ensure access to the su command is restricted
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:

  "6":
    title: System Maintenance
    subsections:
      - "6.1"

  "6.1":
    title: System File Permissions
    subsections:
      - 6.1.1
      - 6.1.2
      - 6.1.3
      - 6.1.4
      - 6.1.5
      - 6.1.6
      - 6.1.7
      - 6.1.8
      - 6.1.9
      - 6.1.10
      - 6.1.11
      - 6.1.12
      - 6.1.13

  6.1.1:
    title: System File Permissions
    profile:
      - Level 2 Server
      - Level 2 Workstation
    vars:
      pkg_verification_file:
        default: /root/pkg_verify
        description: |
          Output of package verification command in remote hosts
        value_type: single
        valid:

  6.1.2:
    title: Ensure permissions on /etc/passwd are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.3:
    title: Ensure permissions on /etc/shadow are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.4:
    title: Ensure permissions on /etc/group are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.5:
    title: Ensure permissions on /etc/gshadow are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.6:
    title: Ensure permissions on /etc/passwd- are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.7:
    title: Ensure permissions on /etc/shadow- are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.8:
    title: Ensure permissions on /etc/group- are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.9:
    title: Ensure permissions on /etc/gshadow- are configured
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.10:
    title: Ensure no world writable files exist
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.11:
    title: Ensure no unowned files or directories exist
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      create_dummy_user:
        default: true
        description: |
          Create dummy user to own the unowned files or directories
        value_type: bool
        valid:
      dummy_username:
        default: foobar
        description: |
          Username of dummy user to own unowned files or directories
        value_type: single
        valid:

  6.1.12:
    title: Ensure no ungrouped files or directories exist
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      create_dummy_group:
        default: true
        description: |
          Create dummy group to own the unowned files or directories
        value_type: bool
        valid:
      dummy_groupname:
        default: foobar
        description: |
          Group name of dummy group to own unowned files or directories
        value_type: single
        valid:

  6.1.13:
    title: Audit SUID executables
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.1.14:
    title: Audit SGID executables
    profile:
      - Level 1 Server
      - Level 1 Workstation

  "6.2":
    title: System File Permissions
    subsections:
      - 6.2.1
      - 6.2.2
      - 6.2.3
      - 6.2.4
      - 6.2.5
      - 6.2.6
      - 6.2.7
      - 6.2.8
      - 6.2.9
      - 6.2.10
      - 6.2.11
      - 6.2.12
      - 6.2.13

  6.2.1:
    title: Ensure password fields are not empty
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.2:
    title: Ensure no legacy "+" entries exist in /etc/passwd
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.3:
    title: Ensure no legacy "+" entries exist in /etc/shadow
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.4:
    title: Ensure no legacy "+" entries exist in /etc/group
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.5:
    title: Ensure root is the only UID 0 account
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.6:
    title: Ensure root PATH integrity
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.7:
    title: Ensure all users' home directories exist
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.8:
    title: >
      Ensure users' home directories permissions are 750 or more restrictive
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
      home_dir_perms:
        default: "0700"
        description: |
          Desired permissions for users' home directories
        value_type: single
        valid:

  6.2.9:
    title: Ensure users own their home directories
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.10:
    title: Ensure users' dot files are not group or world writable
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.11:
    title: Ensure no users have .forward files
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.12:
    title: Ensure no users have .netrc files
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.13:
    title: Ensure users' .netrc Files are not group or world accessible
    profile:
      - Level 1 Server
      - Level 1 Workstation

  6.2.14:
    title: Ensure no users have .rhosts files
    profile:
      - Level 1 Server
      - Level 1 Workstation
    vars:
